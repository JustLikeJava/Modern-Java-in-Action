# Chapter 21. 결론 그리고 자바의 미래

## 21.3 자바 10 지역 변수형 추론
스칼라, C# 등 언어는 지역 변수의 형식을 __var__ 키워드로 대체 가능한다.
이와 같은 __지역 변수형 추론__ 이 자바 10에 추가되었다.
```java
var x = new Car(); 
```
다만 초깃값이 없을 때는 var을 사용할 수 없다.

## 21.4 자바의 미래
### 21.4.1 선언 사이트 변종
자바에서는 __사용 사이트 변종__(use-site variance,제너릭의 서브 형식을 와일드카드로 지정할 수 있는 유연성)을 허용한다. 
즉, 다음처럼 제너릭을 지정할 수 있다. 
```java
List<? extends Number> numbers = new ArrayList<Integer>();
```
하지만 위 코드에서 ? extends가 없으면 컴파일 에러가 발생한다.

C#, 스칼라 같은 많은 프로그래밍 언어는 __선언 사이트 변종__ 이라는 다른 변종 기법을 지원한다. 
* __선언 사이트 변종__  
    * 이를 이용하면 제네릭 클래스를 정의할 때 프로그래머가 변종을 지정할 수 있다. 
    * ? extends나 ? super를 사용할 필요가 없다.

선언 사이트 변종은 클래스를 정의할 때 규격명세를 표현하므로 자바에 추가되면 좋을 것이다.

### 21.4.3 풍부한 형식의 제너릭
자바의 제네릭은 기존 JVM과 호환성을 유지 했어야 했다. 결과적으로 ArrayList<String>이나 ArrayList<Integer> 모두 런타임 표현이 같게 되었다.
이 때문에 가비지 컬렉션이 필드가 참조인지 기본형인지 알 수 있도록 충분한 형식 정보를 런타임에 유지해야 돼서 런타임 비용이 발생하게 된다.
C#과 같이 ArrayList<String>, ArrayList<Integer>, ArrayList<int>가 각각 다른 의미를 갖게 된다면 이런 문제가 해결될 것이다.

### 21.4.4 더 근본적인 불변성 지원
자바에서 함수형 프로그래밍을 구현하려면 '불변값'을 언어적으로 지원해야 한다.
final 키워드의 경우 기본형에서 값이 바뀌는 것을 막을 수 있지만 객체 참조에선 큰 효과가 없다.
따라서 이런 부분을 해결하는 새로운 키워드가 필요하다.



