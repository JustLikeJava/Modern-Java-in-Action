# Chapter 14 자바 모듈 시스템
- 자바9에서 가장 많이 거론되는 새로운 기능은 `모듈 시스템`

## 1. 압력 : 소프트웨어 유추
- 모듈화란 무엇인가?
- 모듈시스템은 어떤 문제를 해결할 수 있는가?

### 관심사분리
- Separation of Concerns
- `SoC`를 적용함으로 모듈이라는 각각의 부분, 겹치지 않는 코드 그룹으로 분리
- 클래스 간의 관계를 시각적으로 보여줄 수 있다
- 장점
  - 개별 기능 따로 작업 > 팀이 쉽게 협업
  - 개별 부분을 재사용하기 쉽다
  - 전체 시스템을 쉽게 유지보수

### 정보 은닉
- 세부 구현을 숨김으로 프로그램의 어떤 부분을 바꿨을 때 다른 부분까지 영향을 미칠 가능성을 줄일 수 있다

### 자바 소프트웨어
- 자바는 객체 지향 언어로 `클래스`, `인터페이스`를 이용
- 그룹 코드 간의 의존성을 시각적으로 보여줄 수 있는 `UML 다이어그램`
- 자바에서는 `public`, `protected`, `private` 등의 접근 제한자와 패키지 수준 접근 권한 등을 이용해 메서드, 필드 클래스의 접근을 제어

<br>

## 2. 자바 모듈 시스템을 설계한 이유
- 자바는 `클래스`, `패키지`, `JAR` 세 가지 수준의 코드 그룹화 제공
- 패키지와 JAR 수준에서는 캡슐화를 지원하지 않는다
- 한 패키지의 클래스와 인터페이스를 다른 패키지로 공개하려면 public으로 이들을 선언
- 보안 측면에서 볼 때 코드가 노출되었으므로 코드를 임의로 조작하는 위협에 더 많이 노출될 수 있다
- 클래스를 모두 컴파일한 다음 보통 한 개의 평범한 `JAR` 파일에 넣고 `JVM`이 동적으로 클래스 경로에 정의된 클래스를 필요할 때 읽는다
- 몇 가지 약점
  - 클래스 경로에는 같은 클래스를 구분하는 버전 개념이 없다
  - 클래스 경로는 명시적인 의존성을 지원하지 않는다
- `메이븐`이나 `그레이들` 같은 빌드 관리 도구는 이런 문제를 해결하는데 도움
> JDK에서 필요한 부분만 골라 사용하고, 클래스 경로를 쉽게 유추할 수 있으며, 플랫폼을 진화시킬 수 있는 강력한 캡슐화를 제공할 새로운 건축 구조가 필요

<br>

## 3. 자바 모듈 : 큰 그림
- 자바 8는 `모듈`이라는 새로운 자바 프로그램 구조 단위 제공
- `module`이라는 키워드에 이름과 바디를 추가해서 정의
- `모듈 디스크립터`라는 `module-info.java` 파일에 저장

<br>

## 4. 자바 모듈 시스템으로 애플리케이션 개발하기
- 실생활에서 단순한 프로젝트를 이처럼 잘게 분해해 작은 기능까지 캡슐화한다면 장점에 비해 초기 비용이 높아지고, 이것이 과연 옳은 결정인가 논란이 생길 수 있다
- `세부적인 모듈화 기법`은 모든 패키지가 자신의 모듈을 가진다
- `거친 모듈화 기법`은 한 모듈이 시스템의 모든 패키지를 포함
- 모듈 디스크립터는 모듈의 소스 코드 파일 루트에 위치
- `--module-path` : 어떤 모듈을 로드할 수 있는지 지정
- `--module` : 실행할 메인 모듈과 클래스를 지정

<br>

## 5. 여러 모듈 활용하기
- `exports`는 다른 모듈에서 사용할 수 있도록 특정 패키지를 공개 형식으로 만든다
- `requires`는 의존하고 있는 모듈을 지정
- 모든 모듈은 `java.base`라는 플랫폼 모듈에 의존하는데 항상 기본적으로 필요한 모듈이므로 명시적으로 지정할 필요가 없다
- 인터넷 도메인명을 역순으로 모듈의 이름으로 정하도록 권고
- 모듈명은 노출된 주요 API 패키지와 이름이 같아야 한다는 규칙

<br>

## 6. 컴파일과 패키징
- 메이븐 > `pom.xml` 추가
- 각 모듈은 독립적으로 컴파일되므로 자체적으로 각각이 한 개의 프로젝트
- `mvn clean package` 명령을 실행해서 프로젝트 모듈을 JAR 파일로 생성

<br>

## 7. 자동 모듈
- 모듈 경로상에 있으나 `module-info` 파일을 가지지 않은 모든 JAR는 `자동 모듈`이 된다
- 자동 모듈은 암묵적으로 자신의 모든 패키지를 노출시킨다

<br>

## 8. 모듈 정의와 구문들
- `module` 지시어를 이용해 모듈을 정의
- `requires` 구문은 컴파일 타임과 런타임에 한 모듈이 다른 모듈에 의존함을 정의
- `exports` 구문은 지정한 패키지를 다른 모듈에서 이용할 수 있도록 공개 형식으로 지정
- `requires transitive` 구문은 다른 모듈에 제공하는 공개 형식을 한 모듈에서 사용할 수 있다고 지정
- `exports to` 구문은 사용자에게 공개할 기능을 제한함으로 가시성을 좀 더 정교하게 제어
- `open` 한정자를 이용하면 모든 패키지를 다른 모듈에 반사적으로 접근을 허용
- `providers` 구문으로 서비스 제공자
- `users` 구문으로 서비스 소비자