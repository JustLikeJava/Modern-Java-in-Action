# 4장
---

## 4.1 스트림이란 무엇인가?

- 데이터 컬렉션 반복을 멋지게 처리하는 기능
- 멀티스레드 코드를 구현하지 않고 데이터를 투명하게 병렬로 처리
  
### 스트림의 이득
- 선언현으로 코드를 구현할 수 있고 변하는 요구사항에 쉽게 대응할 수 있다.
- 복잡한 데이터 처리 파이프라인을 만들 수 있다. -> 가독성, 명확성 유지

### 스트림 API의 특징
- 선언형 : 간결, 가독성 향상
- 조립 가능 : 유연성 향상
- 병렬화 : 성능 향상

## 4.2 스트림 시작하기

### 스트림 이란? : 데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소
- 연속된 요소 : filter, sorted, map 같은 표현 계산식이 주를 이룬다. (컬렉션 - 데이터 / 스트림 - 계산)
- 소스 : 컬렉션, 배열, I/O 자원 등의 데이터 제공 소스로부터 데이터를 소비, 소스 요소와 같은 순서 유지
- 데이터 처리 연산 : 함수형 프로그래밍 언어에서 일반적으로 지원하는 연산과 데이터베이스와 비슷한 연산을 지원

### 스트림의 두 가지 중요 특징
- 파이프라이닝 : 스트림 연산끼리 연결해서 커다란 파이프라인을 구성할 수 있도록 스트림 자신을 반환
- 내부 반복 : 내부 반복 지원
  

## 4.3 스트림과 컬렉션

### 데이터를 언제 계산하느냐가 컬렉션과 스트림의 가장 큰 차이다.
- 컬렉션
  - 자료구조가 포함하는 모든 값을 메모리에 저장하는 자료구조다.
  - 모든 요소는 컬렉션에 추가하기 전에 계산되어야 한다.
  - 적극적으로 생성된다. (생산자 중심 : 팔기 전에 창고를 가득 채움)
- 스트림
  - 요청할 때만 요소를 계산하는 고정된 자료구조다.
  - 생산자와 소비자 관계를 형성한다. 게으른 컬렉션과 같다.

### 딱 한 번만 탐색할 수 있다
- 탐색된 스트림의 요소는 소비된다. 단 한번만 소비할 수 있다는 점을 명심하자.

### 외부 반복과 내부 반복
- 컬렉션 - 외부 반복 (사용자가 직접 요소를 반복, for-each)
- 스트림 - 내부 반복 (반복을 알아서 처리하고 결과 스트림값을 어딘가에 저장)

내부 반복의 장점
- 작업을 투명하게 병렬로 처리하거나 더 최적화된 다양한 순서로 처리
- 데이터 표현과 하드웨어를 활용한 병렬성 구현을 자동으로 선택

## 4.4 스트림 연산
- 중간 연산 : 연결할 수 있는 스트림 연산
- 최종 연산 : 스트림을 닫는 연산

### 중간 연산
- filter, sorted 같은 중간 연산은 다른 스트림을 반환한다.
- 단말 연산을 스트림 파이프라인에 실행하기 전까지 아무 연산도 수행하지 않음 -> 게으름
- 중간 연산을 합친 다음에 합쳐진 중간 연산을 최종 연산으로 한 번에 처리

추가 키워드 : 쇼트서킷, 루프 퓨전

### 최종 연산
- List, Integer, void 등 스트림 이외의 결과가 반환된다.

### 스트림 이용하기
- 데이터 소스 -> 중간 연산 -> 최종 연산
- 빌더 패턴 : 호출을 연결해서 설정을 만들고(=중간 연산) 준비된 설정에 build 메서드를 호출(=최종 연산)