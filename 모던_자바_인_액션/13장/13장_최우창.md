# Chapter 13 디폴트 메서드
- 인터페이스를 변경하면 인터페이스를 구현했던 모든 클래스의 구현도 변경
- 자바 8에서는 이 문제를 해결하는 새로운 기능 제공
  - `정적 메서드 (static method)`
  - `디폴트 메서드 (default method)`
- 자동으로 추가된 디폴트 메서드를 상속받게 된다
- 반환 타입 앞에 `default` 키워드 추가
- 디폴트 메서드를 이용하면 자바 API의 호환성을 유지하면서 라이브러리 변경
- 기본 구현을 그대로 상속하므로 인터페이스에 자유롭게 새로운 메서드 추가
- 정적 메서드와 인터페이스
  - 인터페이스, 인터페이스의 인스턴스를 활용할 수 있는 다양한 정적 메서드를 정의하는 `유틸리티 클래스`
  - 인터페이스는 인스턴스를 생성할 수 없기에 이러한 클래스가 등장
  - 인터페이스에 직접 정적 메서드를 추가할 수 있기에 유틸리티 클래스 사용 감소

## 1. 변화하는 API
- 메서드를 추가하면 API 변경 -> 애플리케이션을 재컴파일하면 에러 발생
- 버전의 차이를 두어 관리하는 방법도 존재
- 그러나
  - 라이브러리 관리가 복잡하다
  - 사용자는 두 가지 라이브러리를 모두 사용해야 한다
- 여러가지 호환성
  - `바이너리 호환성` : 변경 이후 에러 없이 기존 바이너리가 실행될 수 있는 상황
  - `소스 호환성` : 코드를 고쳐도 프로그램을 성공적으로 컴파일 가능
  - `동작 호환성` : 코드 변경 이후 같은 입력값에 대해서는 같은 동작 실행

<br>

## 2. 디폴트 메서드란 무엇인가?
- 인터페이스를 구현하는 클래스에서 구현하지 않은 메서드는 인터페이스 자체에서 기본으로 제공
- default 키워드를 포함하고 메서드 바디를 포함
- 의문점
  - 자바도 다중 상속이 지원되는건가?
  - 같은 시그니처를 가진 디폴트 메서드가 존재한다면 어떤 것을 선택?
- `함수형 인터페이스` : 오직 하나의 추상 메서드를 포함
- `추상 클래스`와 `인터페이스`
  - 클래스는 하나의 추상 클래스만 상속받을 수 있지만 인터페이스를 여러 개 구현
  - 추상 클래스는 인스턴스 변수로 공통 상태를 가질 수 있다. 하지만 인터페이스는 인스턴스 변수 가질 수 없다
  - 추상 클래스는 확장성, 인터페이스는 설계에 알맞은 구현이라는 생각이 들게 되었다

<br>

## 3. 디폴트 메서드 활용 패턴

### 선택형 메서드
- 디폴트 메서드를 이용하면 사용하지 않는 것에 대한 빈 구현을 제공할 필요가 없다

### 동작 다중 상속
- 클래스는 한 개의 클래스만 `상속`할 수 있지만 인터페이스는 여러 개 `구현` 가능
- 디폴트 메서드를 사용하지 않아도 다중 상속 활용 가능
- 옳지 못한 상속
  - 한 개의 메서드를 재사용하려고 여러 개의 메서드가 구현되어 있는 클래스를 상속하는 것은 비효율적
  - `델리게이션` : 멤버 변수를 이용해서 메서드를 직접 호출하도록 작성

<br>

## 4. 해석 규칙
- 같은 시그니처를 갖는 디폴트 메서드를 상속받는 상황이 발생할 수 있다
- 알아야 할 세 가지 해결 규칙
> 1. 클래스가 항상 이긴다. 클래스나 슈퍼클래스에서 정의한 메서드가 디폴트 메서드보다 우선권을 갖는다.
> 2. 1번 이외의 상황에서는 서브인터페이스가 이긴다. 상속관계를 갖는 인터페이스에서 같은 시그니처를 갖는 메서드를 정의할 때는 서브인터페이스가 이긴다.
> 3. 여전히 우선순위가 결정되지 않았다면 클래스가 명시적으로 디폴트 메서드를 오버라이드하고 호출해야 한다.
- 위 규칙에도 불구하고 어떤 메서드를 호출해야 할지 알 수 없는 경우 에러가 발생
- X.super.m(...) 형태의 새로운 문법
  - `X`는 호출하려는 메서드 `m`의 슈퍼인터페이스
- 다이아몬드 문제 고려